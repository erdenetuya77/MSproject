---
title: "–ó—ç—ç–ª —ç—Ä–≥—ç–Ω —Ç”©–ª”©—Ö —ç—Ä—Å–¥—ç–ª–∏–π–Ω “Ø–Ω—ç–ª–≥—ç—ç: Naive Bayes –±–∞ Decision Tree"
subtitle: ""
abstract: >
  –≠–Ω—ç—Ö“Ø“Ø —Ç–∞–π–ª–∞–Ω–¥ –∑—ç—ç–ª–∏–π–Ω –º—ç–¥—ç—ç–ª—ç–ª–¥ —Ç—É–ª–≥—É—É—Ä–ª–∞–Ω –∑—ç—ç–ª —Ö“Ø—Å—ç–≥—á–∏–¥ –∑—ç—ç–ª—ç—ç –±—É—Ü–∞–∞–Ω —Ç”©–ª”©—Ö
  —ç—Å—ç—Ö–∏–π–≥ Naive Bayes –±–æ–ª–æ–Ω Decision Tree –∞–Ω–≥–∏–ª–∞–≥—á –∞—à–∏–≥–ª–∞–Ω —É—Ä—å–¥—á–∏–ª–∞–Ω —Ç–∞–∞–º–∞–≥–ª–∞–≤.
  ”®–≥”©–≥–¥”©–ª –¥—ç—ç—Ä —É—Ä—å–¥—á–∏–ª—Å–∞–Ω –±–æ–ª–æ–≤—Å—Ä—É—É–ª–∞–ª—Ç, —Å—É–¥–∞–ª–≥–∞–∞–Ω—ã —à–∏–Ω–∂–∏–ª–≥—ç—ç (EDA),
  —Ö–æ—ë—Ä —Ç”©—Ä–ª–∏–π–Ω –∞–Ω–≥–∏–ª–∞–≥—á–∏–π–Ω –≥“Ø–π—Ü—ç—Ç–≥—ç–ª–∏–π–≥ —Ö–∞—Ä—å—Ü—É—É–ª–∞–Ω –∞–≤—á “Ø–∑—ç–≤.
author: "Erdenetuya,Bayrbileg"
date: 2025-12-05
date-format: "YYYY –æ–Ω—ã M-—Ä —Å–∞—Ä—ã–Ω D"
project:
  execute-dir: project
  preview: false
toc: true
toc-depth: 3
toc-title: –ê–≥—É—É–ª–≥–∞
number-sections: true
format:
  pdf:
    echo: true
    pdf-engine: xelatex
    papersize: a4paper
    geometry:
      - left=2cm
      - right=2cm
      - top=2cm
      - bottom=3cm
    include-in-header:
      - text: |
          \usepackage[english,mongolian]{babel}
          \usepackage{fontspec}
          \setmainfont{Times New Roman}
          \setmonofont{DejaVu Sans Mono}
          \AddToHook{env/Highlighting/begin}{\footnotesize}
          \usepackage{titling}
          \pretitle{\begin{center}\LARGE\bfseries}
          \posttitle{\par\end{center}\vskip 1em}
          \usepackage{titlesec}
          \titleformat{\section}{\normalfont\Large\bfseries\selectfont}{\thesection}{1em}{}
          \titleformat{\subsection}{\normalfont\large\bfseries\selectfont}{\thesubsection}{1em}{}
          \titleformat{\subsubsection}{\normalfont\normalsize\bfseries\selectfont}{\thesubsubsection}{1em}{}
          \usepackage{tocloft}
          \renewcommand{\cfttoctitlefont}{\Large\bfseries\fontspec{Times New Roman}}
          \renewcommand{\cftaftertoctitle}{\vskip 1em}
          \renewcommand{\cftsecfont}{\normalfont\selectfont}
          \renewcommand{\cftsecpagefont}{\normalfont\selectfont}
          \renewcommand{\cftsubsecfont}{\normalfont\selectfont}
          \renewcommand{\cftsubsecpagefont}{\normalfont\selectfont}
          \renewcommand{\contentsname}{–ê–≥—É—É–ª–≥–∞}
    latex-max-runs: 3
editor: source
execute:
  echo: false
crossref: 
  fig-title: –ó—É—Ä–∞–≥
  fig-prefix: –ó—É—Ä–∞–≥
  tbl-title: –•“Ø—Å–Ω—ç–≥—Ç
  tbl-prefix: –•“Ø—Å–Ω—ç–≥—Ç
fig-align: center
fig-env: "figure"
fig-height: 4
fig-width: 6
fig-pos: "!ht"
fig-format: pdf
fig-cap-location: top
tbl-cap-location: top
bibliography: references.bib
csl: ieee.csl
citeproc: true
link-citations: true
---


```{python}
#| label: setup
#| echo: false

import os
import numpy as np
import pandas as pd

from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import (
accuracy_score,
precision_score,
recall_score,
f1_score,
confusion_matrix,
roc_curve,
roc_auc_score,
)

from sklearn.naive_bayes import GaussianNB
from sklearn.tree import DecisionTreeClassifier
from sklearn.impute import SimpleImputer  # üîπ NaN –Ω”©—Ö”©—Ö”©–¥ —Ö—ç—Ä—ç–≥—Ç—ç–π

import matplotlib.pyplot as plt

# –ì–∞—Ä–∞–ª—Ç —Ö–∞–¥–≥–∞–ª–∞—Ö —Ö–∞–≤—Ç–∞—Å

output_dir = "_files"
if not os.path.exists(output_dir):
os.makedirs(output_dir)

# -----------------------------

# 1. ”®–≥”©–≥–¥”©–ª —É–Ω—à–∏—Ö

# -----------------------------

data = pd.read_csv("data/credit_risk_dataset.csv")

# -----------------------------

# 2. Target –±–∞ Feature-“Ø“Ø–¥–∏–π–≥ —Å–∞–ª–≥–∞—Ö

# -----------------------------

y = data["loan_status"]
X_raw = data.drop(columns=["loan_status"])

# -----------------------------

# 3. NaN-—É—É–¥—ã–≥ –Ω”©—Ö”©—Ö (—Ç–æ–æ–Ω –±–∞ –∞–Ω–≥–∏–ª–∞–ª —Ç—É—Å —Ç—É—Å–∞–¥ –Ω—å)

# -----------------------------

num_cols = X_raw.select_dtypes(include=["int64", "float64"]).columns
cat_cols = X_raw.select_dtypes(include=["object", "bool"]).columns

imputer_num = SimpleImputer(strategy="median")
imputer_cat = SimpleImputer(strategy="most_frequent")

X_raw[num_cols] = imputer_num.fit_transform(X_raw[num_cols])
X_raw[cat_cols] = imputer_cat.fit_transform(X_raw[cat_cols])

# -----------------------------

# 4. One-hot encoding (categorical ‚Üí dummy —Ö—É–≤—å—Å–∞–≥—á)

# -----------------------------

X = pd.get_dummies(X_raw, drop_first=True)

# -----------------------------

# 5. Train / Test Split

# -----------------------------

X_train, X_test, y_train, y_test = train_test_split(
X,
y,
test_size=0.2,
random_state=42,
stratify=y,
)

# -----------------------------

# 6. –°–∫–µ–π–ª —Ö–∏–π—Ö (Naive Bayes-–¥ —Ç–æ—Ö–∏—Ä—É—É–ª–∂)

# -----------------------------

scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)

# –•—ç—Ä–≤—ç—ç –Ω—ç–≥ —à–∞–ª–≥–∞—Ö—ã–≥ —Ö“Ø—Å–≤—ç–ª –¥–∞—Ä–∞–∞—Ö 2 –º”©—Ä–∏–π–≥ —Ç“Ø—Ä –Ω—ç—ç–∂ –±–æ–ª–Ω–æ:

# print(X_train.shape, X_test.shape)

# print(np.isnan(X_train).any(), np.isnan(X_test).any())

```

```{python}
#| label: naive-bayes
#| echo: true

nb_model = GaussianNB()
nb_model.fit(X_train, y_train)

y_pred_nb = nb_model.predict(X_test)
y_proba_nb = nb_model.predict_proba(X_test)[:, 1]

metrics_nb = {
"Accuracy": accuracy_score(y_test, y_pred_nb),
"Precision": precision_score(y_test, y_pred_nb),
"Recall": recall_score(y_test, y_pred_nb),
"F1-score": f1_score(y_test, y_pred_nb),
"AUC": roc_auc_score(y_test, y_proba_nb),
}

metrics_nb
```

```{python}
#| label: decision-tree
#| echo: true

dt_model = DecisionTreeClassifier(max_depth=5, random_state=42)
dt_model.fit(X_train, y_train)

y_pred_dt = dt_model.predict(X_test)
y_proba_dt = dt_model.predict_proba(X_test)[:, 1]

metrics_dt = {
"Accuracy": accuracy_score(y_test, y_pred_dt),
"Precision": precision_score(y_test, y_pred_dt),
"Recall": recall_score(y_test, y_pred_dt),
"F1-score": f1_score(y_test, y_pred_dt),
"AUC": roc_auc_score(y_test, y_proba_dt),
}

metrics_dt
```

```{python}
#| label: compare-metrics
#| echo: true
#| tbl-cap: Naive Bayes –±–∞ Decision Tree –º–æ–¥–µ–ª–∏–π–Ω –≥“Ø–π—Ü—ç—Ç–≥—ç–ª–∏–π–Ω —Ö–∞—Ä—å—Ü—É—É–ª–∞–ª—Ç

compare_df = pd.DataFrame({
"Naive Bayes": metrics_nb,
"Decision Tree": metrics_dt
})
compare_df
```

```{python}
#| label: fig-roc
#| fig-cap: Naive Bayes –±–æ–ª–æ–Ω Decision Tree –º–æ–¥–µ–ª—É—É–¥—ã–Ω ROC –º—É—Ä—É–π
#| echo: false

fpr_nb, tpr_nb, _ = roc_curve(y_test, y_proba_nb)
fpr_dt, tpr_dt, _ = roc_curve(y_test, y_proba_dt)

fig, ax = plt.subplots(figsize=(6,4))
ax.plot(fpr_nb, tpr_nb, label=f"Naive Bayes (AUC={metrics_nb['AUC']:.2f})")
ax.plot(fpr_dt, tpr_dt, label=f"Decision Tree (AUC={metrics_dt['AUC']:.2f})")
ax.plot([0,1],[0,1], linestyle="--", color="grey")
ax.set_xlabel("False Positive Rate")
ax.set_ylabel("True Positive Rate")
ax.legend()
fig.tight_layout()

fig_path = os.path.join(output_dir, "roc_compare.pdf")
fig.savefig(fig_path)
plt.close(fig)
```